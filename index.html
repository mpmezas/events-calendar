<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Events Calendar - Kaseya & MSG Venues</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .last-updated {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        .stats { display: flex; gap: 20px; flex-wrap: wrap; }
        .stat { display: flex; align-items: center; gap: 8px; font-size: 0.95em; }
        .stat-number { font-weight: bold; color: #1e3c72; }
        .stat-number.new-badge { 
            background: #ef4444; 
            color: white; 
            padding: 2px 8px; 
            border-radius: 12px;
            font-size: 0.9em;
        }
        .controls { padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e0e0e0; }
        .view-toggle {
            display: flex;
            gap: 0;
            margin-bottom: 20px;
            border: 2px solid #1e3c72;
            border-radius: 8px;
            overflow: hidden;
            width: fit-content;
        }
        .view-btn {
            padding: 10px 20px;
            background: white;
            color: #1e3c72;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .view-btn:first-child { border-right: 1px solid #1e3c72; }
        .view-btn.active { background: #1e3c72; color: white; }
        .view-btn:hover:not(.active) { background: #e8eef7; }
        .button-group { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary { background: #1e3c72; color: white; }
        .btn-primary:hover {
            background: #2a5298;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30,60,114,0.3);
        }
        .btn-secondary { background: white; color: #1e3c72; border: 2px solid #1e3c72; }
        .btn-secondary:hover { background: #1e3c72; color: white; }
        .category-downloads {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            padding: 20px;
            background: #e8f4f8;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .category-downloads h3 {
            width: 100%;
            font-size: 1em;
            color: #1e3c72;
            margin-bottom: 10px;
        }
        .category-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 0.9em;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: white;
        }
        .category-btn.dolphins { background: #008E97; }
        .category-btn.heat { background: #DC2626; }
        .category-btn.knicks { background: #FDB927; color: #000; }
        .category-btn.rangers { background: #0033A0; }
        .category-btn.other { background: #10B981; }
        .category-btn.sports { background: #F3F4F6; color: #374151; border: 2px solid #9CA3AF; }
        .category-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .filters { display: flex; gap: 15px; flex-wrap: wrap; align-items: center; }
        .filter-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
            position: relative;
        }
        .filter-btn:hover { border-color: #1e3c72; }
        .filter-btn.active { background: #1e3c72; color: white; border-color: #1e3c72; }
        .filter-btn.new-only { background: #fee2e2; border-color: #ef4444; color: #991b1b; }
        .filter-btn.new-only.active { background: #ef4444; color: white; border-color: #ef4444; }
        .checkbox-container { display: flex; align-items: center; }
        .checkbox-container input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; }
        
        /* NEW BADGE */
        .new-badge-pill {
            display: inline-block;
            background: #ef4444;
            color: white;
            font-size: 0.7em;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 8px;
            vertical-align: middle;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .list-view { display: none; padding: 30px; }
        .list-view.active { display: block; }
        .month-section { margin-bottom: 40px; }
        .month-header {
            font-size: 1.8em;
            color: #1e3c72;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #1e3c72;
        }
        .event-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            position: relative;
        }
        .event-card:hover { transform: translateX(5px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
        .event-card.new-event { 
            background: linear-gradient(to right, rgba(239, 68, 68, 0.05) 0%, white 10%);
            border-left-width: 6px;
        }
        .event-card.dolphins {
            border-left-color: #008E97;
            background: linear-gradient(to right, rgba(0, 142, 151, 0.05) 0%, white 10%);
        }
        .event-card.heat {
            border-left-color: #DC2626;
            background: linear-gradient(to right, rgba(220, 38, 38, 0.05) 0%, white 10%);
        }
        .event-card.knicks {
            border-left-color: #FDB927;
            background: linear-gradient(to right, rgba(253, 185, 39, 0.05) 0%, white 10%);
        }
        .event-card.rangers {
            border-left-color: #0033A0;
            background: linear-gradient(to right, rgba(0, 51, 160, 0.05) 0%, white 10%);
        }
        .event-card.other {
            border-left-color: #10B981;
            background: linear-gradient(to right, rgba(16, 185, 129, 0.05) 0%, white 10%);
        }
        .event-card.sports {
            border-left-color: #9CA3AF;
            background: linear-gradient(to right, rgba(156, 163, 175, 0.08) 0%, white 10%);
        }
        .event-info { flex: 1; min-width: 300px; }
        .event-title { 
            font-size: 1.3em; 
            font-weight: 600; 
            color: #1e3c72; 
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .event-details { display: flex; gap: 20px; flex-wrap: wrap; color: #666; font-size: 0.95em; }
        .event-detail { display: flex; align-items: center; gap: 6px; }
        .event-actions { display: flex; gap: 10px; align-items: center; }
        .add-to-cal-btn {
            padding: 10px 20px;
            background: #10B981;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s;
        }
        .add-to-cal-btn:hover { background: #059669; transform: translateY(-2px); }
        
        .calendar-view { display: none; }
        .calendar-view.active { display: block; }
        .month-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px 30px;
            background: white;
            border-bottom: 2px solid #e0e0e0;
        }
        .month-nav button {
            padding: 10px 20px;
            background: #1e3c72;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }
        .month-nav button:hover { background: #2a5298; transform: translateY(-2px); }
        .month-nav button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        .current-month {
            font-size: 1.8em;
            font-weight: 700;
            color: #1e3c72;
            min-width: 250px;
            text-align: center;
        }
        .calendar-container { 
            padding: 30px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e0e0e0;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            min-width: 700px;
        }
        .calendar-header {
            background: #1e3c72;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9em;
        }
        .calendar-day {
            background: white;
            min-height: 120px;
            padding: 8px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        .calendar-day:hover { background: #f8f9fa; }
        .calendar-day.other-month { background: #fafafa; opacity: 0.5; }
        .calendar-day.today { background: #fff3cd; }
        .day-number { font-weight: 600; color: #1e3c72; margin-bottom: 5px; font-size: 0.95em; }
        .calendar-day.other-month .day-number { color: #999; }
        .day-events { display: flex; flex-direction: column; gap: 3px; }
        .calendar-event {
            padding: 4px 6px;
            border-radius: 4px;
            font-size: 0.75em;
            line-height: 1.3;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid;
            background: white;
            position: relative;
        }
        .calendar-event:hover { transform: translateX(3px); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .calendar-event.new-event::after {
            content: '‚Ä¢';
            position: absolute;
            right: 4px;
            top: 2px;
            color: #ef4444;
            font-size: 1.5em;
            line-height: 0.5;
        }
        .calendar-event.dolphins {
            border-left-color: #008E97;
            background: rgba(0, 142, 151, 0.1);
            color: #006b73;
        }
        .calendar-event.heat {
            border-left-color: #DC2626;
            background: rgba(220, 38, 38, 0.1);
            color: #991b1b;
        }
        .calendar-event.knicks {
            border-left-color: #FDB927;
            background: rgba(253, 185, 39, 0.1);
            color: #b8860b;
        }
        .calendar-event.rangers {
            border-left-color: #0033A0;
            background: rgba(0, 51, 160, 0.1);
            color: #002875;
        }
        .calendar-event.other {
            border-left-color: #10B981;
            background: rgba(16, 185, 129, 0.1);
            color: #047857;
        }
        .calendar-event.sports {
            border-left-color: #9CA3AF;
            background: rgba(156, 163, 175, 0.15);
            color: #374151;
        }
        .event-time { font-weight: 600; margin-right: 3px; }
        .more-events { font-size: 0.7em; color: #666; margin-top: 3px; font-style: italic; }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        .modal-header {
            padding: 20px 30px;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-title { font-size: 1.5em; font-weight: 700; color: #1e3c72; }
        .modal-close {
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: #666;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
        }
        .modal-close:hover { color: #1e3c72; }
        .modal-body { padding: 30px; }
        .modal-actions {
            padding: 20px 30px;
            border-top: 2px solid #e0e0e0;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }
        .event-detail-card {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid;
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }
        .event-detail-card.dolphins { border-left-color: #008E97; background: rgba(0, 142, 151, 0.05); }
        .event-detail-card.heat { border-left-color: #DC2626; background: rgba(220, 38, 38, 0.05); }
        .event-detail-card.knicks { border-left-color: #FDB927; background: rgba(253, 185, 39, 0.05); }
        .event-detail-card.rangers { border-left-color: #0033A0; background: rgba(0, 51, 160, 0.05); }
        .event-detail-card.other { border-left-color: #10B981; background: rgba(16, 185, 129, 0.05); }
        .event-detail-card.sports { border-left-color: #9CA3AF; background: rgba(156, 163, 175, 0.08); }
        .event-detail-main { flex: 1; }
        .event-detail-title { 
            font-size: 1.2em; 
            font-weight: 600; 
            color: #1e3c72; 
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .event-detail-info { display: flex; flex-direction: column; gap: 8px; color: #666; }
        .event-detail-info div { display: flex; align-items: center; gap: 8px; }
        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
            justify-content: center;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.9em; }
        .legend-color { width: 20px; height: 20px; border-radius: 4px; border: 2px solid; }
        .legend-color.dolphins { background: rgba(0, 142, 151, 0.2); border-color: #008E97; }
        .legend-color.heat { background: rgba(220, 38, 38, 0.2); border-color: #DC2626; }
        .legend-color.knicks { background: rgba(253, 185, 39, 0.2); border-color: #FDB927; }
        .legend-color.rangers { background: rgba(0, 51, 160, 0.2); border-color: #0033A0; }
        .legend-color.other { background: rgba(16, 185, 129, 0.2); border-color: #10B981; }
        .legend-color.sports { background: rgba(156, 163, 175, 0.2); border-color: #9CA3AF; }
        .no-events { text-align: center; padding: 60px 20px; color: #999; font-size: 1.2em; }
        .footer { background: #1e3c72; color: white; padding: 20px; text-align: center; }
        .help-box {
            background: #fff9e6;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-top: 10px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .help-box strong { color: #92400e; }
        
        @media (max-width: 968px) {
            body { padding: 10px; }
            .container { border-radius: 10px; }
            .header { padding: 30px 20px; }
            .header h1 { font-size: 2em; }
            .header p { font-size: 0.95em; }
            .last-updated { padding: 12px 20px; }
            .controls { padding: 20px; }
            .category-downloads { padding: 15px; }
            .button-group { gap: 10px; }
            .btn { padding: 10px 16px; font-size: 0.9em; }
            .calendar-container { padding: 15px; }
            .calendar { min-width: 650px; }
            .calendar-header { padding: 10px 8px; font-size: 0.85em; }
            .calendar-day { min-height: 100px; padding: 6px; }
            .day-number { font-size: 0.9em; }
            .calendar-event { font-size: 0.7em; padding: 3px 5px; }
            .list-view { padding: 20px; }
            .month-header { font-size: 1.5em; }
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 1.6em; }
            .header p { font-size: 0.85em; }
            .last-updated { padding: 10px 15px; flex-direction: column; align-items: flex-start; }
            .stats { gap: 15px; font-size: 0.9em; }
            .controls { padding: 15px; }
            .view-toggle { width: 100%; }
            .view-btn { flex: 1; justify-content: center; padding: 12px 10px; font-size: 0.9em; }
            .category-downloads { padding: 12px; }
            .category-downloads h3 { font-size: 0.9em; }
            .category-btn { padding: 6px 12px; font-size: 0.8em; }
            .button-group { gap: 8px; }
            .btn { padding: 8px 12px; font-size: 0.85em; }
            .filter-btn { padding: 6px 12px; font-size: 0.85em; }
            .month-nav { padding: 15px 10px; gap: 10px; }
            .month-nav button { padding: 8px 12px; font-size: 0.9em; }
            .current-month { font-size: 1.3em; min-width: 150px; }
            .calendar-container { padding: 10px; }
            .calendar { min-width: 600px; }
            .calendar-header { padding: 8px 4px; font-size: 0.75em; }
            .calendar-day { min-height: 80px; padding: 4px; }
            .day-number { font-size: 0.85em; margin-bottom: 3px; }
            .calendar-event { font-size: 0.65em; padding: 2px 4px; }
            .event-time { display: block; margin-bottom: 2px; }
            .more-events { font-size: 0.65em; }
            .event-card { flex-direction: column; align-items: flex-start; padding: 15px; }
            .event-info { min-width: 100%; }
            .event-title { font-size: 1.1em; }
            .event-details { gap: 10px; font-size: 0.85em; }
            .event-actions { width: 100%; flex-wrap: wrap; }
            .add-to-cal-btn { font-size: 0.85em; }
            .list-view { padding: 15px; }
            .month-header { font-size: 1.3em; }
            .modal-content { margin: 10px; }
            .modal-header { padding: 15px 20px; }
            .modal-title { font-size: 1.2em; }
            .modal-body { padding: 20px; }
            .modal-actions { padding: 15px 20px; }
            .legend { padding: 15px 20px; gap: 15px; }
            .legend-item { font-size: 0.85em; }
            .help-box { font-size: 0.85em; padding: 12px; }
        }

        @media (max-width: 480px) {
            .header h1 { font-size: 1.4em; }
            .header p { font-size: 0.8em; }
            .calendar { min-width: 550px; }
            .calendar-header { font-size: 0.7em; padding: 6px 2px; }
            .calendar-day { min-height: 70px; padding: 3px; }
            .day-number { font-size: 0.8em; }
            .calendar-event { font-size: 0.6em; }
            .current-month { font-size: 1.1em; min-width: 120px; }
            .month-nav button { padding: 6px 10px; font-size: 0.85em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìÖ 2026 Events Calendar</h1>
            <p>üîµ Dolphins ‚Ä¢ üî¥ Miami Heat ‚Ä¢ üü° Knicks ‚Ä¢ ‚ö™ Rangers ‚Ä¢ ‚ö™ Sports ‚Ä¢ üü¢ Other Events</p>
            <p style="margin-top: 5px; font-size: 0.9em;">Kaseya Center & MSG Venues & Hard Rock Stadium ‚Ä¢ Auto-Updated Every 2 Weeks</p>
        </div>

        <div class="last-updated">
            <div class="stats">
                <div class="stat">
                    <span>üìÖ Last Updated:</span>
                    <span class="stat-number" id="lastUpdated">Loading...</span>
                </div>
                <div class="stat">
                    <span>üìä Total Events:</span>
                    <span class="stat-number" id="totalEvents">0</span>
                </div>
                <div class="stat">
                    <span>üÜï New Events:</span>
                    <span class="stat-number new-badge" id="newEventsCount">0</span>
                </div>
                <div class="stat">
                    <span>‚úÖ Selected:</span>
                    <span class="stat-number" id="selectedCount">0</span>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="view-toggle">
                <button class="view-btn active" onclick="switchView('calendar')">üìÖ Calendar View</button>
                <button class="view-btn" onclick="switchView('list')">üìã List View</button>
            </div>

            <div class="category-downloads">
                <h3>üé® Download by Category (for automatic Google Calendar colors):</h3>
                <button class="category-btn dolphins" onclick="downloadCategory('dolphins')">
                    üîµ Dolphins Calendar (0 events)
                </button>
                <button class="category-btn heat" onclick="downloadCategory('heat')">
                    üî¥ Miami Heat Calendar (<span id="heatCount">27</span> events)
                </button>
                <button class="category-btn knicks" onclick="downloadCategory('knicks')">
                    üü° Knicks Calendar (8 events)
                </button>
                <button class="category-btn rangers" onclick="downloadCategory('rangers')">
                    ‚ö™ Rangers Calendar (6 events)
                </button>
                <button class="category-btn sports" onclick="downloadCategory('sports')">
                    ‚ö™ Sports Calendar (<span id="sportsCount">18</span> events)
                </button>
                <button class="category-btn other" onclick="downloadCategory('other')">
                    üü¢ Other Events Calendar (<span id="otherCount">55</span> events)
                </button>
                <div class="help-box">
                    <strong>üí° For color-coded Google Calendar:</strong> Download each category separately, import each as a different calendar in Google Calendar, then assign colors to each calendar (Red for Heat, Yellow for Knicks, Blue for Rangers, Gray/White for Sports, Green for Other, etc.). All events in that calendar will automatically have that color!
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="addAllSelected()">üì• Add Selected to Calendar</button>
                <button class="btn btn-secondary" onclick="selectAll()">‚òëÔ∏è Select All</button>
                <button class="btn btn-secondary" onclick="deselectAll()">‚òê Deselect All</button>
            </div>

            <div class="filters">
                <div class="filter-group">
                    <span style="font-weight: 600;">Filter:</span>
                    <button class="filter-btn active" onclick="filterCategory('all')">All Events</button>
                    <button class="filter-btn new-only" onclick="filterCategory('new')">üÜï New Only</button>
                    <button class="filter-btn" onclick="filterCategory('dolphins')">üîµ Dolphins</button>
                    <button class="filter-btn" onclick="filterCategory('heat')">üî¥ Miami Heat</button>
                    <button class="filter-btn" onclick="filterCategory('knicks')">üü° Knicks</button>
                    <button class="filter-btn" onclick="filterCategory('rangers')">‚ö™ Rangers</button>
                    <button class="filter-btn" onclick="filterCategory('sports')">‚ö™ Sports</button>
                    <button class="filter-btn" onclick="filterCategory('other')">üü¢ Other</button>
                </div>
            </div>
        </div>

        <div class="calendar-view active">
            <div class="month-nav">
                <button onclick="previousMonth()" id="prevBtn">‚Üê Previous</button>
                <div class="current-month" id="currentMonth">January 2026</div>
                <button onclick="nextMonth()" id="nextBtn">Next ‚Üí</button>
            </div>
            <div class="calendar-container">
                <div class="calendar" id="calendar"><div class="loading">Loading calendar...</div></div>
            </div>
        </div>

        <div class="list-view" id="listView"><div class="loading">Loading events...</div></div>

        <div class="legend">
            <div class="legend-item"><div class="legend-color dolphins"></div><span>üîµ Dolphins (0)</span></div>
            <div class="legend-item"><div class="legend-color heat"></div><span>üî¥ Miami Heat (<span id="legendHeatCount">27</span>)</span></div>
            <div class="legend-item"><div class="legend-color knicks"></div><span>üü° Knicks (8)</span></div>
            <div class="legend-item"><div class="legend-color rangers"></div><span>‚ö™ Rangers (6)</span></div>
            <div class="legend-item"><div class="legend-color sports"></div><span>‚ö™ Sports (<span id="legendSportsCount">18</span>)</span></div>
            <div class="legend-item"><div class="legend-color other"></div><span>üü¢ Other (<span id="legendOtherCount">55</span>)</span></div>
        </div>

        <div class="footer">
            <p>Data from <strong>Kaseya Center</strong> & <strong>MSG Venues</strong> (Madison Square Garden, Radio City Music Hall, Beacon Theatre, Infosys Theater)</p>
            <p style="margin-top: 10px; opacity: 0.8;">Auto-updated via GitHub Actions ‚Ä¢ Dolphins play at Hard Rock Stadium (not included in these venues)</p>
            <p style="margin-top: 5px; opacity: 0.7; font-size: 0.9em;">üÜï = Event added in last update</p>
        </div>
    </div>

    <div class="modal" id="eventModal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title" id="modalDate">Events</div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="selectAllInModal()">‚òëÔ∏è Select All</button>
                <button class="btn btn-primary" onclick="addSelectedFromModal()">üì• Add Selected to Calendar</button>
            </div>
        </div>
    </div>

    <script>
        let allEvents = [];
        let currentFilter = 'all';
        let currentView = 'calendar';
        let currentDate = new Date(2026, 0, 1);
        const monthNames = ["January", "February", "March", "April", "May", "June",
                           "July", "August", "September", "October", "November", "December"];
        const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

        async function loadEvents() {
            try {
                const response = await fetch('events.json');
                const data = await response.json();
                allEvents = data.events;
                
                const updateDate = new Date(data.lastUpdated);
                const formattedDate = updateDate.toLocaleDateString('en-US', { 
                    month: 'short', day: 'numeric', year: 'numeric' 
                });
                const formattedTime = updateDate.toLocaleTimeString('en-US', { 
                    hour: 'numeric', minute: '2-digit', hour12: true 
                });
                document.getElementById('lastUpdated').textContent = `${formattedDate} at ${formattedTime}`;
                document.getElementById('totalEvents').textContent = allEvents.length;
                
                // Count new events
                const newEvents = allEvents.filter(e => e.isNew === true);
                document.getElementById('newEventsCount').textContent = newEvents.length;
                
                const heatCount = allEvents.filter(e => e.category === 'heat').length;
                const sportsCount = allEvents.filter(e => e.category === 'sports').length;
                const otherCount = allEvents.filter(e => e.category === 'other').length;
                document.getElementById('heatCount').textContent = heatCount;
                document.getElementById('sportsCount').textContent = sportsCount;
                document.getElementById('otherCount').textContent = otherCount;
                document.getElementById('legendHeatCount').textContent = heatCount;
                document.getElementById('legendSportsCount').textContent = sportsCount;
                document.getElementById('legendOtherCount').textContent = otherCount;
                
                renderCalendar();
                renderList();
            } catch (error) {
                document.getElementById('calendar').innerHTML = 
                    '<div class="no-events">Error loading events. Please try again later.</div>';
            }
        }

        function switchView(view) {
            currentView = view;
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (view === 'calendar') {
                document.querySelector('.calendar-view').classList.add('active');
                document.querySelector('.list-view').classList.remove('active');
            } else {
                document.querySelector('.calendar-view').classList.remove('active');
                document.querySelector('.list-view').classList.add('active');
            }
        }

        function renderList() {
            const container = document.getElementById('listView');
            let filteredEvents = allEvents.filter(event => {
                if (currentFilter === 'new') return event.isNew === true;
                return currentFilter === 'all' || event.category === currentFilter;
            });

            if (filteredEvents.length === 0) {
                container.innerHTML = '<div class="no-events">No events found matching your criteria.</div>';
                return;
            }

            const eventsByMonth = {};
            filteredEvents.forEach(event => {
                const date = new Date(event.date);
                const monthKey = date.toLocaleString('default', { month: 'long', year: 'numeric' });
                if (!eventsByMonth[monthKey]) eventsByMonth[monthKey] = [];
                eventsByMonth[monthKey].push(event);
            });

            const sortedMonths = Object.keys(eventsByMonth).sort((a, b) => {
                return new Date(eventsByMonth[a][0].date) - new Date(eventsByMonth[b][0].date);
            });

            let html = '';
            let eventIndex = 0;
            sortedMonths.forEach(month => {
                html += `<div class="month-section"><h2 class="month-header">${month}</h2>`;
                eventsByMonth[month].forEach(event => {
                    const date = new Date(event.date);
                    const dayName = date.toLocaleDateString('default', { weekday: 'short' });
                    const dateStr = date.toLocaleDateString('default', { month: 'short', day: 'numeric' });
                    const eventId = `list-event-${eventIndex++}`;
                    const newBadge = event.isNew ? '<span class="new-badge-pill">NEW</span>' : '';
                    const newClass = event.isNew ? 'new-event' : '';
                    
                    html += `
                        <div class="event-card ${event.category} ${newClass}" data-event-id="${event.date}-${event.title.replace(/\s/g, '-')}">
                            <div class="event-info">
                                <div class="event-title">${event.title}${newBadge}</div>
                                <div class="event-details">
                                    <div class="event-detail">üìÖ ${dayName}, ${dateStr}</div>
                                    <div class="event-detail">üïê ${event.time}</div>
                                    <div class="event-detail">üìç ${event.venue}</div>
                                    <div class="event-detail">üé´ ${event.type}</div>
                                </div>
                            </div>
                            <div class="event-actions">
                                <div class="checkbox-container">
                                    <input type="checkbox" id="${eventId}" onchange="updateSelectedCount()">
                                </div>
                                <button class="add-to-cal-btn" onclick="addSingleEvent('${event.title.replace(/'/g, "\\'")}', '${event.date}')">
                                    Add to Calendar
                                </button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            });

            container.innerHTML = html;
            updateSelectedCount();
        }

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;
            
            const isFirstMonth = (year === 2026 && month === 0);
            const isLastMonth = (year === 2026 && month === 11);
            document.getElementById('prevBtn').disabled = isFirstMonth;
            document.getElementById('nextBtn').disabled = isLastMonth;
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();
            
            const monthEvents = allEvents.filter(event => {
                const eventDate = new Date(event.date);
                const matchesMonth = eventDate.getMonth() === month && eventDate.getFullYear() === year;
                if (currentFilter === 'new') return matchesMonth && event.isNew === true;
                const matchesCategory = currentFilter === 'all' || event.category === currentFilter;
                return matchesMonth && matchesCategory;
            });
            
            const eventsByDay = {};
            monthEvents.forEach(event => {
                const day = new Date(event.date).getDate();
                if (!eventsByDay[day]) eventsByDay[day] = [];
                eventsByDay[day].push(event);
            });
            
            let html = '';
            dayNames.forEach(day => html += `<div class="calendar-header">${day}</div>`);
            
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                html += `<div class="calendar-day other-month"><div class="day-number">${day}</div></div>`;
            }
            
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = (day === today.getDate() && month === today.getMonth() && year === today.getFullYear());
                const dayEvents = eventsByDay[day] || [];
                const hasEvents = dayEvents.length > 0;
                
                html += `<div class="calendar-day ${isToday ? 'today' : ''}" 
                              ${hasEvents ? `onclick="showDayEvents(${year}, ${month}, ${day})"` : ''}>
                    <div class="day-number">${day}</div><div class="day-events">`;
                
                dayEvents.slice(0, 3).forEach(event => {
                    const time = formatTime(event.time);
                    const title = truncateText(event.title, 25);
                    const newClass = event.isNew ? 'new-event' : '';
                    html += `<div class="calendar-event ${event.category} ${newClass}">
                        <span class="event-time">${time}</span>${title}
                    </div>`;
                });
                
                if (dayEvents.length > 3) {
                    html += `<div class="more-events">+${dayEvents.length - 3} more</div>`;
                }
                html += `</div></div>`;
            }
            
            const totalCells = firstDay + daysInMonth;
            const remainingCells = totalCells % 7 === 0 ? 0 : 7 - (totalCells % 7);
            for (let day = 1; day <= remainingCells; day++) {
                html += `<div class="calendar-day other-month"><div class="day-number">${day}</div></div>`;
            }
            
            document.getElementById('calendar').innerHTML = html;
        }

        function formatTime(timeStr) {
            const [hours, minutes] = timeStr.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            return `${hour12}${ampm}`;
        }

        function truncateText(text, maxLength) {
            return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
        }

        function showDayEvents(year, month, day) {
            const date = new Date(year, month, day);
            const dateStr = date.toISOString().split('T')[0];
            
            const dayEvents = allEvents.filter(event => {
                const matchesDate = event.date === dateStr;
                if (currentFilter === 'new') return matchesDate && event.isNew === true;
                const matchesCategory = currentFilter === 'all' || event.category === currentFilter;
                return matchesDate && matchesCategory;
            });
            
            if (dayEvents.length === 0) return;
            dayEvents.sort((a, b) => a.time.localeCompare(b.time));
            
            const dayName = date.toLocaleDateString('default', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
            document.getElementById('modalDate').textContent = dayName;
            
            let html = '';
            let eventIndex = 0;
            dayEvents.forEach(event => {
                const eventId = `modal-event-${eventIndex++}`;
                const newBadge = event.isNew ? '<span class="new-badge-pill">NEW</span>' : '';
                html += `
                    <div class="event-detail-card ${event.category}" data-event-id="${event.date}-${event.title.replace(/\s/g, '-')}">
                        <div class="checkbox-container">
                            <input type="checkbox" id="${eventId}" class="modal-checkbox" onchange="updateSelectedCount()">
                        </div>
                        <div class="event-detail-main">
                            <div class="event-detail-title">${event.title}${newBadge}</div>
                            <div class="event-detail-info">
                                <div>üïê ${event.time}</div>
                                <div>üìç ${event.venue}</div>
                                <div>üé´ ${event.type}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('modalBody').innerHTML = html;
            document.getElementById('eventModal').classList.add('active');
        }

        function closeModal(event) {
            if (!event || event.target.id === 'eventModal') {
                document.getElementById('eventModal').classList.remove('active');
            }
        }

        function selectAll() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
            updateSelectedCount();
        }

        function deselectAll() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateSelectedCount();
        }

        function selectAllInModal() {
            document.querySelectorAll('.modal-checkbox').forEach(cb => cb.checked = true);
            updateSelectedCount();
        }

        function updateSelectedCount() {
            const count = document.querySelectorAll('input[type="checkbox"]:checked').length;
            document.getElementById('selectedCount').textContent = count;
        }

        function addSingleEvent(title, date) {
            const event = allEvents.find(e => e.title === title && e.date === date);
            if (event) {
                const ics = createICS([event]);
                downloadICSFile(ics, `${event.title.replace(/\s/g, '-')}.ics`);
            }
        }

        function addAllSelected() {
            const selectedEvents = [];
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                const card = cb.closest('[data-event-id]');
                if (card) {
                    const [date, ...titleParts] = card.dataset.eventId.split('-');
                    const title = titleParts.join(' ');
                    const event = allEvents.find(e => e.date === date && e.title.replace(/\s/g, '-') === titleParts.join('-'));
                    if (event) selectedEvents.push(event);
                }
            });

            if (selectedEvents.length === 0) {
                alert('Please select at least one event!');
                return;
            }

            const ics = createICS(selectedEvents);
            downloadICSFile(ics, 'selected-events.ics');
        }

        function addSelectedFromModal() {
            const selectedEvents = [];
            document.querySelectorAll('.modal-checkbox:checked').forEach(cb => {
                const card = cb.closest('[data-event-id]');
                if (card) {
                    const [date, ...titleParts] = card.dataset.eventId.split('-');
                    const title = titleParts.join(' ');
                    const event = allEvents.find(e => e.date === date && e.title.replace(/\s/g, '-') === titleParts.join('-'));
                    if (event) selectedEvents.push(event);
                }
            });

            if (selectedEvents.length === 0) {
                alert('Please select at least one event!');
                return;
            }

            const ics = createICS(selectedEvents);
            downloadICSFile(ics, 'selected-events.ics');
            closeModal();
        }

        function downloadCategory(category) {
            const categoryEvents = allEvents.filter(e => e.category === category);
            
            if (categoryEvents.length === 0) {
                alert(`No ${category} events found!`);
                return;
            }

            const ics = createICS(categoryEvents);
            const categoryNames = {
                'dolphins': 'Dolphins',
                'heat': 'Miami-Heat',
                'knicks': 'Knicks',
                'rangers': 'Rangers',
                'sports': 'Sports-Events',
                'other': 'Other-Events'
            };
            downloadICSFile(ics, `${categoryNames[category]}-2026.ics`);
        }

        function createICS(events) {
            let ics = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//2026 Events Calendar//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:2026 Events
X-WR-TIMEZONE:America/New_York
`;

            events.forEach(event => {
                const date = new Date(event.date + ' ' + event.time);
                const dtStart = date.toISOString().replace(/[-:]/g, '').split('.')[0];
                const uid = `${dtStart}-${event.title.replace(/\s/g, '-')}@calendar2026`;
                
                ics += `BEGIN:VEVENT
UID:${uid}
DTSTAMP:${new Date().toISOString().replace(/[-:]/g, '').split('.')[0]}Z
DTSTART:${dtStart}
SUMMARY:${event.title}
DESCRIPTION:${event.type}
LOCATION:${event.venue}
STATUS:CONFIRMED
END:VEVENT
`;
            });

            ics += 'END:VCALENDAR';
            return ics;
        }

        function downloadICSFile(content, filename) {
            const blob = new Blob([content], { type: 'text/calendar' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function filterCategory(category) {
            currentFilter = category;
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderCalendar();
            renderList();
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        loadEvents();
    </script>
</body>
</html>
